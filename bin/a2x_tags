#!/usr/bin/env python3

import os, subprocess, sys

def main():
    if len(sys.argv) != 2:
        print("Usage: {} HeaderFile".format(os.path.basename(sys.argv[0])))
        return

    header_file = os.path.abspath(sys.argv[1])

    def geany_tags(path):
        path = os.path.expanduser(path)

        print("Looking for {}".format(path))

        if os.path.exists(path):
            print("Writing Geany tags file: {}".format(path))

            subprocess.call("geany -g {} {}" \
                .format(os.path.join(path, "a2x.c.tags"), header_file),
                shell = True)

    geany_tags(os.path.join("~", ".config", "geany", "tags"))

if __name__ == "__main__":
    main()
