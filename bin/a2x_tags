#!/usr/bin/env python3

import os
import sys

from utils.output import Output
from utils.shell import Shell

def geany_tags(header_file, path):
    path = os.path.expanduser(path)
    Output.info('Looking for Geany tags: {}'.format(path))

    if os.path.exists(path):
        Shell.run('geany -g {} {}'
            .format(os.path.join(path, 'a2x.c.tags'), header_file))

def main():
    Output.title('tags', sys.argv)

    if len(sys.argv) != 2:
        Output.error('Usage: {} HeaderFile'.format(os.path.basename(sys.argv[0])))

    header_file = os.path.abspath(sys.argv[1])
    geany_tags(header_file, os.path.join('~', '.config', 'geany', 'tags'))

    Output.info('Done')

if __name__ == '__main__':
    main()
