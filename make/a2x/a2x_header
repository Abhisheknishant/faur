#!/usr/bin/env python

import os, sys

def main():
    if len(sys.argv) != 3:
        print("Usage: " + os.path.basename(sys.argv[0]) + "SourceDir HeaderFile")
        return

    source_dir = os.path.abspath(sys.argv[1])
    header_file = os.path.abspath(sys.argv[2])

    print("Writing header " + os.path.basename(header_file))

    with open(header_file, "w") as f:
        f.write("#ifndef A2X_H\n")
        f.write("#define A2X_H\n\n")

        headers = [h for h in os.listdir(source_dir) if h[-4 :] == ".p.h"]
        headers.sort(key = lambda h: h)

        for h in headers:
            f.write('#include "../src/' + h + '"\n')

        f.write("\n#endif // A2X_H\n")

if __name__ == "__main__":
    main()
